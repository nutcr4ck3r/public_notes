# Vim の基本的な操作：カーソル操作

ここからは、Vim の基本的な操作を学んでいきます。

まずは基本中の基本、カーソル移動からです。

『いやいや、さすがにそれぐらいは出来るッスよ？』と言う方もいるでしょうが、
まずは独特な Vim のカーソル移動を体験してみてください。

## 1. 下準備

操作練習用のファイルとして、`sample.py`という名前のファイルを作成し、
以下コードをコピー＆ペーストして保存して下さい。
内容は Python のスクリプトとなっています。

```python
import requests
import json
import os


# ファイルに結果を書き込み
def output_2_file(jsons):
    i = 1
    for x in jsons['results']:
        with open('result.txt', mode='a') as f:
            print('No. %s' % i, file=f)
            print('Zip code: %s' % x['zipcode'], file=f)
            print('Address: %s%s%s' %
                 (x['address1'], x['address2'], x['address3']), file=f)
            print('Ruby: %s%s%s' %
                 (x['kana1'], x['kana2'], x['kana3']), file=f)
            print('')
            i += 1


# メイン処理部分
results = 'result.txt'  # 結果を書き込むファイル
zipCode = input('Please input ZIP code for search: ')

baseUrl = 'https://zipcloud.ibsnet.co.jp/api/search'
limitNo = 20  # 取得する最大件数
parData = {'zipcode': zipCode, 'limit': limitNo}

# API 問い合わせの実行
response = requests.get(baseUrl, parData)

# 結果を辞書型に変換
jsons = json.loads(response.text)

# 結果ファイルが存在する場合は削除
if os.path.isfile(results):
    os.remove(results)

try:
    output_2_file(jsons)  # 結果をファイルに書き込み
except:  # エラー処理
    print('Error!')

    if jsons['message'] != None:  # エラーメッセージがある場合
        print(jsons['message'])
    else:  # エラーメッセージがない場合
        print('指定の郵便番号は存在しません。.')
```

## 2. カーソル移動：基本的な移動

### 2.1. 上下左右の移動

最初に、上下左右の移動です。

すでに触れた通り、基本的なカーソル移動は次の通りとなります。

なお、カーソル移動は、基本的に非インプットモード（ノーマルモード）
での操作となりますので、
`i`キーを押してインプットモードに入らないように注意して下さい。

もしもインプットモードに入ってしまった場合は、`ESC`キーで抜けることができます。

```text
カーソル移動
  左：h (又は左矢印キー)
  下：j (又は下矢印キー)
  上：k (又は上矢印キー)
  右：l (又は右矢印キー)
```

`hjkl`のいずれか、又は矢印キーでカーソルを移動しますが、Vim を使うのであれば、
個人的には`hjkl`キーの使用をおすすめします。
理由は、大半のキーボードの矢印キーはホームポジションから離れているため、
タッチタイピングのできる人間からしてみれば、入力操作の障害でしかないからです。

最初は慣れが必要かもしれませんが、使っている内に、
自由自在にカーソル移動ができるようになることでしょう。

### 2.2. スクロールアップ・スクロールダウン

```text
スクロールアップ：Ctrl + u
スクロールダウン：Ctrl + d
```

スクロールアップ／ダウンは、キーボードの `PageUp`, `PageDown`に似た機能です。

ただし、`.vimrc`で設定していない場合、スクロールする行数は、
デフォルトではページ全体の半分ずつとなります。

ちなみに、画面行数分を移動する操作も存在しますが、
移動量が多くなる分、現在位置を見失いやすくなるので、
普段は半画面移動のこちらを使用する事をお勧めします。

`PageUp`, `PageDown`も、矢印キー同様、入力操作を妨げる要因となりますので、
素早い操作の為には入力できるようになっていた方がよいでしょう。

### 2.3. 行頭・行末への移動

```text
行頭へジャンプ：(  ※デフォルトでは 0
行末へジャンプ：)  ※デフォルトでは $
```

行頭・行末へのジャンプは、キーボードの`Home`, `End`と同様の機能です。

この機能は、デフォルトだと`行頭ジャンプ＝0`, `行末ジャンプ＝$`という、
かなり覚えにくい設定となっている為、`.vimrc`でキーバインドを変更しています。

ただ、この行頭・行末ジャンプは、後述する入力操作の部分で代用できる為、
使う機会は少ないかもしれません。

### 2.4. ファイルの先頭・最後への移動

```text
先頭へジャンプ：gg
最後へジャンプ：Shift + g
```

この機能は、キーボードで`Ctrl + Home`, `Ctrl + End`と同じ機能ですが、
これまで同様、キーボードの本来のキーを押すよりも早くジャンプすることが可能です。

## 3. カーソルの移動：Vim 特有の移動

ここまでの移動は、キーボード本来のキーでも可能なカーソル移動でしたので、
そこまで必要性を感じることは無かったかもしれません。

しかし、ここからは Vim でしか実現できない、Vim 特有のカーソル移動となります。

### 3.1. 行番号を指定してジャンプ

```text
指定行へジャンプ：数字＋gg 又は 数字＋G
```

指定した番号の行数にジャンプします。

ファイルのどのあたりに何があるのかを把握しておくのは困難ですが、
『概ねこのあたり』と、アタリをつけて移動する際に、
何度もページスクロールをする手間を省くことができます。

### 3.2. 単語の先頭・末尾にジャンプ

```text
次の単語の先頭にジャンプ：w
前の単語の先頭にジャンプ：Shift + w  ※デフォルトでは b
次の単語の末尾にジャンプ：e
前の単語の末尾にジャンプ：Shift + e  ※デフォルトでは ge
```

英語の文章で大きな効果を発揮するジャンプ。日本語やプログラミングコードでも、
一応はジャンプしてくれます。

文字単位のカーソル移動にイライラした時に。

### 3.3. 段落ごとにジャンプ

```text
次の段落にジャンプ：Shift + [
前の段落にジャンプ：Shift + ]
```

英語や日本語の文章は勿論、プログラミングコードでも威力を発揮するキーバインド。

Python のように、定期的に空白行を挟むよう推奨されている言語の場合、
キリのいい部分（コードブロック）でジャンプする為、編集が大変捗ります。

### 3.4. 対となるカッコの位置にジャンプ

```text
対のカッコにジャンプ：％
```

プログラミングコードの編集時に便利なキーバインドです。

Python はカッコを多用しない為、そこまで恩恵はありませんが、
Javascript などのカッコ満載言語であれば、遠く離れた位置にあるカッコも、
即座に見つけることができるようになります。

## 4. カーソル移動：まとめ

ここまでのキーバインドをまとめましょう。

出来るだけ直観的にピンとくる物をピックアップしつつ、
一部は覚えやすいようにキーを変更してあります。

Vim には、他にも多数の移動系キーバインドが存在していますが、
普段使いする場合は、これらを覚えておけば十分でしょう。

また、ここに挙げた物についても、無理に全てを覚える必要はありませんので、
自分が使いやすい・便利だと感じたものだけ覚えてもらって構いません。

```text
カーソル移動
  左：h (又は左矢印キー)
  下：j (又は下矢印キー)
  上：k (又は上矢印キー)
  右：l (又は右矢印キー)

スクロールアップ：Ctrl + u
スクロールダウン：Ctrl + d

行頭へジャンプ：(  ※デフォルトでは 0
行末へジャンプ：)  ※デフォルトでは $

先頭へジャンプ：gg
最後へジャンプ：Shift + g

指定行へジャンプ：数字＋gg 又は 数字＋G

次の単語の先頭にジャンプ：w
前の単語の先頭にジャンプ：Shift + w  ※デフォルトでは b
次の単語の末尾にジャンプ：e
前の単語の末尾にジャンプ：Shift + e  ※デフォルトでは ge

次の段落にジャンプ：Shift + [
前の段落にジャンプ：Shift + ]

対のカッコにジャンプ：％
```
